# üìö –û–ø–∏—Å–∞–Ω–∏–µ –∫–ª–∞—Å—Å–∞ `History`

## üöÄ –£–ø—Ä–∞–≤–ª—è–µ—Ç –∏—Å—Ç–æ—Ä–∏–µ–π —á–∞—Ç–∞ —Å –ø–æ–¥–¥–µ—Ä–∂–∫–æ–π –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏–π, —Å–∏—Å—Ç–µ–º–Ω—ã–º–∏ –ø—Ä–æ–º–ø—Ç–∞–º–∏ –∏ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ–º –≤ JSON

–ö–ª–∞—Å—Å `History` –ø—Ä–µ–¥–Ω–∞–∑–Ω–∞—á–µ–Ω –¥–ª—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–µ–π —á–∞—Ç–æ–≤, –≤–∫–ª—é—á–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫—É —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤, –∞ —Ç–∞–∫–∂–µ –∏—Ö —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏–∑ —Ñ–∞–π–ª–∞ JSON.

> ‚ùó **–í–∞–∂–Ω–æ**:  
> Grok –º–æ–∂–µ—Ç –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω–æ –≤–æ—Å–ø—Ä–∏–Ω–∏–º–∞—Ç—å –∏—Å—Ç–æ—Ä–∏—é. –ü–æ—ç–∫—Å–ø–µ—Ä–∏–º–µ–Ω—Ç–∏—Ä—É–π—Ç–µ —Å `history_as_json`. –í—Å–µ–≥–¥–∞ –º–æ–∂–Ω–æ –æ—Ç–∫–ª—é—á–∏—Ç—å –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏, —É—Å—Ç–∞–Ω–æ–≤–∏–≤ `history_msg_count` –Ω–∞ `0` (–ø–æ —É–º–æ–ª—á–∞–Ω–∏—é –∏ —Ç–∞–∫ `history_msg_count = 0`).

> üìÅ **–°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –≤ —Ñ–∞–π–ª**:  
> –ò—Å—Ç–æ—Ä–∏—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø–æ–¥–≥—Ä—É–∂–∞–µ—Ç—Å—è –∏–∑ —Ñ–∞–π–ª–∞ –ø—Ä–∏ –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–∏ `GrokClient`, –Ω–æ —Å–æ—Ö—Ä–∞–Ω—è—Ç—å –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ –≤—Ä—É—á–Ω—É—é, –≤—ã–∑—ã–≤–∞—è `client.history.to_file`.

---

### üåü –ü—Ä–∏–º–µ—Ä
```python
from grok3api.client import GrokClient

def main():
    # –ê–∫—Ç–∏–≤–∏—Ä—É–µ–º –∞–≤—Ç–æ-—Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è 5 —Å–æ–æ–±—â–µ–Ω–∏–π 
    client = GrokClient(history_msg_count=5)
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±—â–∏–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç
    client.history.set_main_system_prompt("–ü—Ä–µ–¥—Å—Ç–∞–≤—å —á—Ç–æ —Ç—ã –±–∞—Å–∫–µ—Ç–±–æ–ª–∏—Å—Ç")
    while True:
        prompt = input("–í–µ–¥–∏—Ç–µ –∑–∞–ø—Ä–æ—Å: ")
        if prompt == "q": break
        result = client.send_message(prompt, "0")
        print(result.modelResponse.message)
        
        # –í—Ä—É—á–Ω—É—é —Å–æ—Ö—Ä–∞–Ω—è–µ–º –∏—Å—Ç–æ—Ä–∏—é –≤ —Ñ–∞–π–ª
        client.history.to_file()

if __name__ == '__main__':
    main()
```
---

### üì® **–ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è**

–ö–ª–∞—Å—Å `History` –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∏—Ä—É–µ—Ç—Å—è **–∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –ø—Ä–∏ —Å–æ–∑–¥–∞–Ω–∏–∏ GrokClient** —Å–æ —Å–ª–µ–¥—É—é—â–∏–º–∏ –ø–∞—Ä–∞–º–µ—Ç—Ä–∞–º–∏:

| –ü–∞—Ä–∞–º–µ—Ç—Ä            | –¢–∏–ø    | –û–ø–∏—Å–∞–Ω–∏–µ                                                          | –ü–æ —É–º–æ–ª—á–∞–Ω–∏—é            |
|---------------------|--------|-------------------------------------------------------------------|-------------------------|
| `history_msg_count` | `int`  | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—Ä–∏–∏ —á–∞—Ç–∞                  | `0`                     |
| `history_path`      | `str`  | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É JSON –¥–ª—è —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –∏ –∑–∞–≥—Ä—É–∑–∫–∏ –∏—Å—Ç–æ—Ä–∏–∏               | `"chat_histories.json"` |
| `history_as_json`   | `bool` | –§–æ—Ä–º–∞—Ç –≤—ã–≤–æ–¥–∞ –∏—Å—Ç–æ—Ä–∏–∏: JSON (`True`) –∏–ª–∏ —Å—Ç—Ä–æ–∫–∞ (`False`)         | `True`                  |
| `history_auto_save` | `bool` | –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –ø–µ—Ä–µ–∑–∞–ø–∏—Å—å –∏—Å—Ç–æ—Ä–∏–∏ –≤ —Ñ–∞–π–ª –ø–æ—Å–ª–µ –∫–∞–∂–¥–æ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è. | `True`                  |


---

### üéØ **–ê—Ç—Ä–∏–±—É—Ç—ã**

| –ê—Ç—Ä–∏–±—É—Ç              | –¢–∏–ø                                                  | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                                                                                          |
|----------------------|------------------------------------------------------|---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `chat_histories`     | `Dict[str, List[Dict[str, Union[str, List[Dict]]]]]` | –°–ª–æ–≤–∞—Ä—å, –≥–¥–µ –∫–ª—é—á–∏ ‚Äî –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä—ã –∏—Å—Ç–æ—Ä–∏–∏ (`history_id`), –∞ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî —Å–ø–∏—Å–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏–π. –ö–∞–∂–¥–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ —Å–æ–¥–µ—Ä–∂–∏—Ç `role` (—Ç–∏–ø –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è) –∏ `content` (—Å–ø–∏—Å–æ–∫ —Å —Ç–µ–∫—Å—Ç–æ–º –∏/–∏–ª–∏ –∏–∑–æ–±—Ä–∞–∂–µ–Ω–∏—è–º–∏). |
| `history_msg_count`  | `int`                                                | –ú–∞–∫—Å–∏–º–∞–ª—å–Ω–æ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–æ–æ–±—â–µ–Ω–∏–π –≤ –∏—Å—Ç–æ—Ä–∏–∏ –¥–ª—è –∫–∞–∂–¥–æ–≥–æ `history_id`.                                                                                                                             |
| `system_prompts`     | `Dict[str, str]`                                     | –°–ª–æ–≤–∞—Ä—å —Å–∏—Å—Ç–µ–º–Ω—ã—Ö –ø—Ä–æ–º–ø—Ç–æ–≤, –≥–¥–µ –∫–ª—é—á–∏ ‚Äî `history_id`, –∞ –∑–Ω–∞—á–µ–Ω–∏—è ‚Äî —Ç–µ–∫—Å—Ç–æ–≤—ã–µ –ø—Ä–æ–º–ø—Ç—ã –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω—ã—Ö –∏—Å—Ç–æ—Ä–∏–π.                                                                                      |
| `main_system_prompt` | `Optional[str]`                                      | –û—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –ø—Ä–∏–º–µ–Ω—è–µ–º—ã–π, –µ—Å–ª–∏ –¥–ª—è `history_id` –Ω–µ –∑–∞–¥–∞–Ω —Å–ø–µ—Ü–∏—Ñ–∏—á–µ—Å–∫–∏–π –ø—Ä–æ–º–ø—Ç.                                                                                                      |
| `history_path`       | `str`                                                | –ü—É—Ç—å –∫ —Ñ–∞–π–ª—É JSON –¥–ª—è —Ö—Ä–∞–Ω–µ–Ω–∏—è –∏—Å—Ç–æ—Ä–∏–∏.                                                                                                                                                           |
| `history_as_json`    | `bool`                                               | –£–∫–∞–∑—ã–≤–∞–µ—Ç, –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å –ª–∏ –∏—Å—Ç–æ—Ä–∏—é –≤ —Ñ–æ—Ä–º–∞—Ç–µ JSON (`True`) –∏–ª–∏ –∫–∞–∫ —Å—Ç—Ä–æ–∫—É —Å —É–∫–∞–∑–∞–Ω–∏–µ–º –æ—Ç–ø—Ä–∞–≤–∏—Ç–µ–ª—è (`False`).                                                                                        |

---

### üìú **–ú–µ—Ç–æ–¥—ã**

| –ú–µ—Ç–æ–¥                    | –ü–∞—Ä–∞–º–µ—Ç—Ä—ã                                                                                       | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç | –û–ø–∏—Å–∞–Ω–∏–µ                                                                                                                                                                                                                                                           |
|--------------------------|-------------------------------------------------------------------------------------------------|------------|--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------|
| `set_main_system_prompt` | `text: str`                                                                                     | -          | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç –æ—Å–Ω–æ–≤–Ω–æ–π —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç, –∫–æ—Ç–æ—Ä—ã–π –±—É–¥–µ—Ç –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å—Å—è –ø–æ —É–º–æ–ª—á–∞–Ω–∏—é. –ü—Ä–∏ –≤–æ–∑–Ω–∏–∫–Ω–æ–≤–µ–Ω–∏–∏ –æ—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ —á–µ—Ä–µ–∑ `logger.error`.                                                                                                             |
| `set_system_prompt`      | `history_id: str`, `text: str`                                                                  | -          | –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∏—Å—Ç–æ—Ä–∏–∏. –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `logger.error`.                                                                                                                                                     |
| `get_system_prompt`      | `history_id: str`                                                                               | `str`      | –í–æ–∑–≤—Ä–∞—â–∞–µ—Ç —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç –¥–ª—è —É–∫–∞–∑–∞–Ω–Ω–æ–≥–æ –∏–¥–µ–Ω—Ç–∏—Ñ–∏–∫–∞—Ç–æ—Ä–∞ –∏–ª–∏ –ø—É—Å—Ç—É—é —Å—Ç—Ä–æ–∫—É, –µ—Å–ª–∏ –ø—Ä–æ–º–ø—Ç –Ω–µ —É—Å—Ç–∞–Ω–æ–≤–ª–µ–Ω. –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `logger.error`.                                                                                                                    |
| `to_file`                | -                                                                                               | -          | –°–æ—Ö—Ä–∞–Ω—è–µ—Ç —Ç–µ–∫—É—â–∏–µ –¥–∞–Ω–Ω—ã–µ (`chat_histories`, `system_prompts`, `main_system_prompt`) –≤ —Ñ–∞–π–ª JSON. –î–∞–Ω–Ω—ã–µ –∑–∞–ø–∏—Å—ã–≤–∞—é—Ç—Å—è —Å –æ—Ç—Å—Ç—É–ø–∞–º–∏ –∏ –±–µ–∑ –ø—Ä–∏–Ω—É–¥–∏—Ç–µ–ª—å–Ω–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è ASCII. –û—à–∏–±–∫–∏ –ª–æ–≥–∏—Ä—É—é—Ç—Å—è —á–µ—Ä–µ–∑ `logger.error`.                                                |

---

> üí° **–ü—Ä–∏–º–µ—á–∞–Ω–∏–µ**:  
> –ï—Å–ª–∏ `history_msg_count = 0`, –∏—Å—Ç–æ—Ä–∏—è –±—É–¥–µ—Ç —Å–æ–¥–µ—Ä–∂–∞—Ç—å —Ç–æ–ª—å–∫–æ —Å–∏—Å—Ç–µ–º–Ω—ã–π –ø—Ä–æ–º–ø—Ç (–ø—Ä–∏ –µ–≥–æ –Ω–∞–ª–∏—á–∏–∏).
